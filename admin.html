<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Amazon Control</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap');
        body { font-family: 'Kanit', sans-serif; background: #1b3022; color: white; padding: 20px; margin: 0; }
        .container { background: rgba(0,0,0,0.5); padding: 30px; border-radius: 20px; border: 1px solid #a2cf6e; max-width: 900px; margin: 40px auto; }
        h2 { color: #a2cf6e; text-align: center; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px; border-bottom: 1px solid #5d8a39; text-align: left; }
        th { background: #2d5a27; color: #a2cf6e; }
        .btn-edit { background: #ffc107; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; margin-right: 5px; }
        .btn-del { background: #ff5252; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer; }
        .btn-back { color: #a2cf6e; text-decoration: none; border: 1px solid #a2cf6e; padding: 5px 15px; border-radius: 20px; display: inline-block; margin-bottom: 15px; }
        .loading { text-align: center; padding: 20px; color: #888; }
    </style>
</head>
<body>

    <div class="container">
        <a href="index.html" class="btn-back">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</a>
        <h2>üõ† ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏®‡∏¥‡∏©‡∏¢‡πå‡πÄ‡∏Å‡πà‡∏≤‡πÉ‡∏ô‡∏û‡∏á‡πÑ‡∏û‡∏£</h2>
        
        <table>
            <thead>
                <tr>
                    <th>‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                    <th>‡∏£‡∏∏‡πà‡∏ô</th>
                    <th>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</th>
                    <th>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£</th>
                </tr>
            </thead>
            <tbody id="data-list">
                <tr><td colspan="4" class="loading">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td></tr>
            </tbody>
        </table>
    </div>

    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxenJW7x8Tt-L60AUXUTBxGNhAIDHtWq6IPXrm0LJVoO0LoPsAYqwozO5DQ6kCrMh91/exec';

        async function loadData() {
            const tbody = document.getElementById('data-list');
            try {
                const res = await fetch(SCRIPT_URL);
                const data = await res.json();
                tbody.innerHTML = '';
                data.forEach((item, index) => {
                    tbody.innerHTML += `
                        <tr>
                            <td>${item.name}</td>
                            <td>${item.batch}</td>
                            <td>${item.phone}</td>
                            <td>
                                <button class="btn-edit" onclick="editData(${index},'${item.name}','${item.batch}','${item.phone}')">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                                <button class="btn-del" onclick="deleteData(${index})">‡∏•‡∏ö</button>
                            </td>
                        </tr>`;
                });
            } catch (e) { tbody.innerHTML = '<tr><td colspan="4" class="loading">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ</td></tr>'; }
        }

        async function sendAction(payload) {
            await fetch(SCRIPT_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(payload) });
            alert("‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à (‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà)");
            setTimeout(loadData, 1500);
        }

        function deleteData(index) {
            if (confirm("‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πà‡πÑ‡∏´‡∏°?")) sendAction({ action: 'delete', index: index });
        }

        function editData(index, n, b, p) {
            const name = prompt("‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏´‡∏°‡πà:", n);
            const batch = prompt("‡∏£‡∏∏‡πà‡∏ô‡πÉ‡∏´‡∏°‡πà:", b);
            const phone = prompt("‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà:", p);
            if (name && batch && phone) {
                sendAction({ action: 'edit', index: index, name: name, batch: batch, phone: phone });
            }
        }

        window.onload = loadData;
    </script>
</body>
</html>
